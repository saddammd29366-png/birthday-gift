<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Choose Your Gift üéÅ</title>
  <link rel="stylesheet" href="style.css">

  <!-- Preload images -->
  <link rel="preload" as="image" href="cover1.png">
  <link rel="preload" as="image" href="cover2.png">
  <link rel="preload" as="image" href="cover3.png">
  <link rel="preload" as="image" href="cover4.png">
  <link rel="preload" as="image" href="gift1.jpg">
  <link rel="preload" as="image" href="gift2.jpg">
  <link rel="preload" as="image" href="gift3.jpg">
  <link rel="preload" as="image" href="gift4.jpg">
</head>

<body>

<!-- Background Music -->
<audio id="bgMusic" loop preload="auto" playsinline>
  <source src="bg-music.mp3" type="audio/mpeg">
</audio>

<button id="muteBtn" onclick="toggleMusic()" style="display:none;">
  üîá Mute Music
</button>

<h1>üéÅ Your Birthday Gifts ‚ù§Ô∏é</h1>

<div id="wishMessage">
  <p>Dear <span id="userName">My Special One</span>,</p>
  <p>Here are 4 mystery gifts! Pick the one you like the most üíñ</p>
</div>

<!-- Gift options -->
<div id="giftOptions">

  <div class="giftCard" onclick="chooseGift(0)">
    <img class="giftImage" src="gift1.jpg" alt="Gift 1" loading="eager">
    <img class="cover" src="cover1.png" alt="Mystery Gift" loading="eager">
  </div>

  <div class="giftCard" onclick="chooseGift(1)">
    <img class="giftImage" src="gift2.jpg" alt="Gift 2" loading="eager">
    <img class="cover" src="cover2.png" alt="Mystery Gift" loading="eager">
  </div>

  <div class="giftCard" onclick="chooseGift(2)">
    <img class="giftImage" src="gift3.jpg" alt="Gift 3" loading="eager">
    <img class="cover" src="cover3.png" alt="Mystery Gift" loading="eager">
  </div>

  <div class="giftCard" onclick="chooseGift(3)">
    <img class="giftImage" src="gift4.jpg" alt="Gift 4" loading="eager">
    <img class="cover" src="cover4.png" alt="Mystery Gift" loading="eager">
  </div>

</div>

<script>
/* =========================
   GOOGLE SHEET LOGGING
   ========================= */

/* üî¥ PASTE YOUR GOOGLE WEB APP URL HERE */
const LOG_URL = "https://script.google.com/macros/s/AKfycbwZmpI07ZG70hkS6Xg497oD2DJYPPzAAfZUXpLJl261dk9IUn-5GQx2NIW_HugC70oFaA/exec";

/* =========================
   USER NAME
   ========================= */
document.getElementById("userName").innerText =
  sessionStorage.getItem("username") || "My Special One";

/* =========================
   MUSIC
   ========================= */
const music = document.getElementById("bgMusic");
const muteBtn = document.getElementById("muteBtn");

if (sessionStorage.getItem("music") === "on") {
  const startOnTap = () => {
    music.volume = 0.6;
    music.play().then(() => {
      muteBtn.style.display = "block";
    }).catch(()=>{});
  };
  document.addEventListener("touchstart", startOnTap, { once:true });
  document.addEventListener("click", startOnTap, { once:true });
}

function toggleMusic(){
  if (music.paused) {
    music.play();
    muteBtn.innerText = "üîá Mute Music";
  } else {
    music.pause();
    muteBtn.innerText = "üîä Play Music";
  }
}

/* =========================
   GIFT LOGIC + SHEET LOG
   ========================= */

let giftChosen = false;

function chooseGift(index){
  if (giftChosen) return;

  const name = sessionStorage.getItem("username") || "Unknown";

  /* Send data to Google Sheet */
  fetch(LOG_URL, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify({
      name: name,
      gift: index + 1,
      ua: navigator.userAgent
    })
  });

 /* Reveal selected gift */
const cards = document.querySelectorAll(".giftCard");

cards.forEach((card, i) => {
  const cover = card.querySelector(".cover");
  const giftImg = card.querySelector(".giftImage");

  if (i === index) {
    // make sure card can layer images correctly
    card.style.position = "relative";
    card.style.overflow = "hidden";

    // force gift image to be visible and full size
    giftImg.style.display = "block";
    giftImg.style.position = "absolute";
    giftImg.style.inset = "0";
    giftImg.style.width = "100%";
    giftImg.style.height = "100%";
    giftImg.style.objectFit = "cover";
    giftImg.style.opacity = "1";
    giftImg.style.visibility = "visible";
    giftImg.style.zIndex = "2";

    // hide cover safely (even if CSS is weird)
    cover.style.position = "absolute";
    cover.style.inset = "0";
    cover.style.opacity = "0";
    cover.style.visibility = "hidden";
    cover.style.pointerEvents = "none";
    cover.style.zIndex = "3";

  } else {
    card.style.display = "none";
  }
});



  giftChosen = true;
}
</script>

</body>
</html>






